<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Landslide Dynamics Simulator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
    <h1>ğŸ”ï¸ Landslide Dynamics Simulator</h1>
    <p class="subtitle">Interactive infinite slope stability analysis with physics-based infiltration modeling, pore pressure dynamics, and probabilistic failure prediction using First-Order Second-Moment reliability theory.</p>
    
    <div class="layout">
        <!-- Controls Panel -->
        <div class="controls">
            <div class="control-group">
                <h3>ğŸŒ¿ Environmental Factors</h3>
                <label class="block">Vegetation Cover (%)</label>
                <div class="slider-container">
                    <input id="vegetation" type="range" min="0" max="100" step="5" value="50"/>
                </div>
                <div class="value-display">
                    <strong id="vegVal">50%</strong>
                    <span class="effect">Root cohesion: +<span id="vegEffect">1.5</span> kPa</span>
                </div>

                <label class="block" style="margin-top:12px">Soil Erosion Level (%)</label>
                <div class="slider-container">
                    <input id="erosion" type="range" min="0" max="100" step="5" value="20"/>
                </div>
                <div class="value-display">
                    <strong id="erosionVal">20%</strong>
                    <span class="effect">Cohesion loss: -<span id="erosionEffect">1.5</span> kPa</span>
                </div>

                <label class="block" style="margin-top:12px">Initial Soil Moisture (%)</label>
                <div class="slider-container">
                    <input id="soilMoisture" type="range" min="0" max="100" step="5" value="30"/>
                </div>
                <div class="value-display">
                    <strong id="moistureVal">30%</strong>
                    <span class="effect">Initial ráµ¤: <span id="moistureEffect">0.30</span></span>
                </div>

                <label class="block" style="margin-top:12px">Rainfall Intensity (mm/hr)</label>
                <div class="slider-container">
                    <input id="rainIntensity" type="range" min="0" max="100" step="5" value="10"/>
                </div>
                <div class="value-display">
                    <strong id="rainVal">10 mm/hr</strong>
                    <span class="effect">Infiltration rate</span>
                </div>
                <div class="time-display" id="timeDisplay">Elapsed: 0.0 min | Rain: 0.0 mm</div>
            </div>

            <div class="control-group">
                <h3>âš™ï¸ Geotechnical Parameters</h3>
                <label class="block">Soil Depth z (m)</label>
                <input id="soilDepth" type="number" min="0.5" max="10" step="0.1" value="3.0"/>
                
                <label class="block">Unit Weight Î³ (kN/mÂ³)</label>
                <input id="unitWeight" type="number" min="15" max="22" step="0.1" value="19.0"/>
                
                <label class="block">Base Cohesion c' (kPa)</label>
                <input id="cohesionGeo" type="number" min="0" max="50" step="1" value="15"/>
                
                <label class="block">Friction Angle Ï†' (Â°)</label>
                <input id="phiGeo" type="number" min="15" max="45" step="0.5" value="32"/>
                
                <label class="block">Slope Angle Î² (Â°)</label>
                <input id="slopeAngle" type="number" min="5" max="60" step="1" value="30"/>
                
                <label class="block">Hydraulic Conductivity k (Ã—10â»â¶ m/s)</label>
                <input id="hydCond" type="number" min="0.1" max="100" step="0.5" value="5.0"/>
                
                <div class="info-box">
                    <strong>Model Validity:</strong> Infinite slope assumes uniform soil, parallel failure surface, and slope length >> depth. Valid for Î² < Ï†' and L/z > 25.
                </div>
            </div>

            <div class="control-group">
                <h3>ğŸ“Š Reliability Analysis</h3>
                <label class="block">Coefficient of Variation (CoV)</label>
                <div class="slider-container">
                    <input id="fosSigma" type="range" min="0.05" max="0.40" step="0.01" value="0.15"/>
                </div>
                <div class="value-display">
                    <strong id="covVal">15%</strong>
                    <span class="effect">Parameter uncertainty</span>
                </div>
                <div class="info-box">
                    <strong>About CoV:</strong> Represents material variability and measurement uncertainty. Typical: Dense soil (10-15%), Loose soil (20-30%), Highly variable (30-40%)
                </div>
            </div>

            <button class="educational-toggle" onclick="toggleEducational()">ğŸ“ STUDENT GUIDE</button>  
            <div class="control-group">
                <h3>ğŸ® Simulation Controls</h3>
                <button id="rainBtn" class="btn-rain">ğŸŒ§ï¸ Start Rain</button>
                <button id="triggerBtn" class="btn-warning">âš ï¸ Force Landslide</button>
                <button id="resetBtn" class="btn-secondary">ğŸ”„ Reset Simulation</button>
                
                <div class="rain-status" id="rainStatus" style="display:none">
                    <strong>ğŸŒ§ï¸ Rain Active</strong><br>
                    Time: <span id="rainTime">0.0</span> min<br>
                    Infiltration: <span id="infiltStatus">â€”</span> mm<br>
                    ráµ¤ rate: <span id="ruRate">â€”</span>/hr
                </div>
                
                <div class="info-box" style="margin-top:12px">
                    <strong>âš¡ Auto-Trigger:</strong> Landslide automatically initiates when FoS &lt; 1.0 or PoF &gt; 50%. Rain increases pore pressure based on infiltration physics!
                </div>
                
                <div class="info-box" style="margin-top:8px;background:#fef3c7;border-left-color:#f59e0b;color:#78350f">
                    <strong>â±ï¸ Time Acceleration:</strong> Simulation runs at 300Ã— speed (1 real second = 5 simulated minutes) to demonstrate rainfall effects within reasonable viewing time.
                </div>
            </div>

            <div class="explain">
                <strong>ğŸ”¬ Infinite Slope Stability Equations</strong><br>
                <strong style="margin-top:8px;display:block">Factor of Safety:</strong>
                FoS = [c'â‚‘ff + (Î³z cosÂ²Î² - u)tan Ï†'â‚‘ff] / [Î³z sinÎ² cosÎ²]<br>
                <strong style="margin-top:6px;display:block">Effective Parameters:</strong>
                - c'â‚‘ff = c'â‚€(1 + 0.15V)(1 - 0.55E)<br>
                - Ï†'â‚‘ff = Ï†'â‚€ + 1.5VÂ° (vegetation roughness)<br>
                - u = ráµ¤Î³wz (pore water pressure)<br>
                <strong style="margin-top:6px;display:block">Infiltration Model:</strong>
                ráµ¤(t) = ráµ¤â‚€ + [min(I,k)Â·t]/(nÂ·z) Â· f(k)<br>
                where I = rainfall, k = conductivity, n = porosity, f(k) = permeability factor<br>
                <strong style="margin-top:6px;display:block">Probability of Failure:</strong>
                PoF = Î¦[(1 - Î¼_FoS)/(Ïƒ_FoS)] where Ïƒ = CoV Ã— Î¼_FoS
            </div>
            
            <div class="warning-box">
                <strong>âš ï¸ Important Limitations:</strong><br>
                â€¢ <strong>Time acceleration:</strong> 300Ã— speed with empirical calibration - use for conceptual understanding, not quantitative predictions<br>
                â€¢ <strong>Simplified infiltration:</strong> Doesn't use full Green-Ampt; assumes uniform wetting front<br>
                â€¢ <strong>Homogeneous soil:</strong> Real slopes have layers with different properties<br>
                â€¢ <strong>2D analysis:</strong> Ignores 3D effects and lateral water flow<br>
                â€¢ <strong>FOSM simplification:</strong> Applies CoV to FoS directly; true FOSM propagates parameter uncertainties<br>
                â€¢ <strong>No progressive failure:</strong> Assumes simultaneous failure across entire zone<br>
                â€¢ <strong>Vegetation simplified:</strong> No time-dependent root decay or seasonal variations<br>
                â€¢ <strong>Valid only when:</strong> Î² &lt; Ï†', L/z &gt; 25, parallel seepage assumption holds
            </div>
        </div>

        <!-- Canvas Area -->
        <div class="canvas-area">
            <div class="canvas-wrapper">
                <canvas id="mainCanvas" width="1000" height="480"></canvas>
            </div>
            
            <div class="canvas-zoom-controls">
                <div class="canvas-zoom-level" id="canvasZoomLevel">Zoom: 100%</div>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <div class="label">Factor of Safety</div>
                    <div class="value" id="fosValue">â€”</div>
                    <div class="desc" id="fosStatus">Calculating...</div>
                </div>
                <div class="stat">
                    <div class="label">Failure Probability</div>
                    <div class="value" id="pofValue">â€”</div>
                    <div class="desc" id="pofStatus">Calculating...</div>
                </div>
                <div class="stat">
                    <div class="label">Pore Pressure Ratio</div>
                    <div class="value" id="ruValue">â€”</div>
                    <div class="desc">ráµ¤ = u / (Î³wz)</div>
                </div>
                <div class="stat">
                    <div class="label">Effective Cohesion</div>
                    <div class="value" id="ceffValue">â€”</div>
                    <div class="desc">With vegetation & erosion</div>
                </div>
                <div class="stat">
                    <div class="label">System Status</div>
                    <div class="value" id="systemStatus">ğŸŸ¢ Stable</div>
                    <div class="desc">Displaced: <strong id="fallenCount">0</strong> particles</div>
                </div>
            </div>

            <div class="chart-wrap">
                <div>
                    <canvas id="trendCanvas" width="920" height="180"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background:#2563eb"></div>
                        <span><strong>Factor of Safety</strong><br><small>Target: FoS â‰¥ 1.5</small></span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background:#dc2626"></div>
                        <span><strong>Failure Prob (%)</strong><br><small>Target: PoF &lt; 5%</small></span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background:#10b981"></div>
                        <span><strong>Threshold Line</strong><br><small>FoS = 1.0 (Limit)</small></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Educational Guide Panel -->
<div class="educational-panel" id="educationalPanel">
    <div class="educational-header">
        <span>ğŸ“– How This Simulation Works</span>
        <button onclick="toggleEducational()" style="background:none;border:none;color:#fff;font-size:1.3rem;cursor:pointer;padding:0 5px">Ã—</button>
    </div>
    <div class="educational-content" id="educationalContent">
        <div class="edu-section">
            <h4>ğŸ¯ What is This Simulator?</h4>
            <p>This tool helps you understand <strong>landslides</strong> - when soil on a slope becomes unstable and slides downhill. You'll see how different factors like rain, vegetation, and soil properties affect slope stability.</p>
        </div>
        
        <div class="edu-section">
            <h4>ğŸŒ¿ Environmental Factors (What You Can Change)</h4>
            
            <div class="edu-item">
                <strong>ğŸŒ± Vegetation Cover</strong>
                <p>Plants and trees on the slope. Their roots hold soil together like natural anchors.</p>
                <ul>
                    <li><strong>High vegetation (70-100%):</strong> More stable - roots bind soil</li>
                    <li><strong>Low vegetation (0-30%):</strong> Less stable - soil easily moves</li>
                </ul>
            </div>

            <div class="edu-item">
                <strong>ğŸ”ï¸ Soil Erosion Level</strong>
                <p>How much the soil has been worn away by weather and time.</p>
                <ul>
                    <li><strong>Low erosion (0-20%):</strong> Soil is strong and cohesive</li>
                    <li><strong>High erosion (60-100%):</strong> Soil is weak and crumbly</li>
                </ul>
            </div>

            <div class="edu-item">
                <strong>ğŸ’§ Initial Soil Moisture</strong>
                <p>How wet the soil is before rain starts.</p>
                <ul>
                    <li><strong>Dry soil (0-30%):</strong> Can absorb more water initially</li>
                    <li><strong>Wet soil (60-100%):</strong> Already saturated, adds pressure quickly</li>
                </ul>
            </div>

            <div class="edu-item">
                <strong>ğŸŒ§ï¸ Rainfall Intensity</strong>
                <p>How hard it's raining (millimeters per hour).</p>
                <ul>
                    <li><strong>Light rain (0-20 mm/hr):</strong> Slow water infiltration</li>
                    <li><strong>Heavy rain (60-100 mm/hr):</strong> Fast saturation, higher risk</li>
                </ul>
            </div>
        </div>

        <div class="edu-section">
            <h4>ğŸ” What the Numbers Mean</h4>
            
            <div class="edu-item">
                <strong>ğŸ¯ Factor of Safety (FoS)</strong>
                <p>Think of this as a "strength score" - how much stronger the soil is than it needs to be.</p>
                <ul>
                    <li><strong>FoS â‰¥ 1.5:</strong> âœ… Safe - slope is stable</li>
                    <li><strong>FoS = 1.0-1.5:</strong> âš ï¸ Caution - getting risky</li>
                    <li><strong>FoS &lt; 1.0:</strong> âŒ Danger - landslide likely!</li>
                </ul>
            </div>

            <div class="edu-item">
                <strong>ğŸ“Š Probability of Failure (PoF)</strong>
                <p>The chance (in %) that a landslide will happen. Accounts for uncertainty in measurements.</p>
                <ul>
                    <li><strong>PoF &lt; 5%:</strong> Very low risk</li>
                    <li><strong>PoF = 20-50%:</strong> Moderate to high risk</li>
                    <li><strong>PoF &gt; 50%:</strong> Extreme risk - failure imminent</li>
                </ul>
            </div>

            <div class="edu-item">
                <strong>ğŸ’¦ Pore Pressure Ratio (ráµ¤)</strong>
                <p>Measures water pressure between soil particles. Higher water pressure = weaker soil.</p>
                <ul>
                    <li><strong>ráµ¤ = 0-0.3:</strong> Relatively dry, stable</li>
                    <li><strong>ráµ¤ = 0.5-0.7:</strong> Getting saturated, weakening</li>
                    <li><strong>ráµ¤ &gt; 0.8:</strong> Very wet, high failure risk</li>
                </ul>
            </div>
        </div>

        <div class="edu-section">
            <h4>ğŸ® How to Use the Simulator</h4>
            <ol class="edu-steps">
                <li><strong>Start with defaults:</strong> Click "ğŸ”„ Reset to Optimal" for safe starting conditions</li>
                <li><strong>Adjust one factor:</strong> Try increasing erosion or decreasing vegetation</li>
                <li><strong>Watch the numbers:</strong> See how FoS and PoF change in real-time</li>
                <li><strong>Start rain:</strong> Click "ğŸŒ§ï¸ Start Rain" and watch water infiltrate</li>
                <li><strong>Observe failure:</strong> When conditions are bad enough, landslide triggers automatically!</li>
                <li><strong>Experiment:</strong> Reset and try different combinations</li>
            </ol>
        </div>

        <div class="edu-section">
            <h4>ğŸ§ª Experiment Ideas</h4>
            <div class="edu-item">
                <strong>Experiment 1: Role of Vegetation</strong>
                <p>Set vegetation to 80%, start rain. Watch FoS. Reset, set vegetation to 10%, start rain. Compare how quickly FoS drops!</p>
            </div>
            <div class="edu-item">
                <strong>Experiment 2: Rainfall Effect</strong>
                <p>Start with defaults. Try light rain (10 mm/hr) vs heavy rain (80 mm/hr). Which triggers failure faster?</p>
            </div>
            <div class="edu-item">
                <strong>Experiment 3: Combined Factors</strong>
                <p>Create worst-case: high erosion (80%), low vegetation (10%), high moisture (70%), heavy rain (80%). How long until failure?</p>
            </div>
        </div>

        <div class="edu-section">
            <h4>â±ï¸ About Time Acceleration</h4>
            <p>Real landslides can take hours or days of rain. This simulator speeds up time by 300Ã— so you can see results in minutes instead of waiting hours! 1 second in the simulation = 5 minutes of real time.</p>
        </div>
    </div>
</div>
<!-- Formula Panel -->
<div class="formula-panel" id="formulaPanel">
    <button class="formula-toggle" onclick="toggleFormulas()">ğŸ“š FORMULAS</button>
    <div class="formula-header">
        <span>ğŸ” Theory & Equations</span>
        <button onclick="toggleFormulas()" style="background:none;border:none;color:#fff;font-size:1.3rem;cursor:pointer;padding:0 5px">Ã—</button>
    </div>
    <div class="formula-content" id="formulaContent">
        <div class="formula-section">
            <h4>ğŸ¯ Factor of Safety (FoS)</h4>
            <div class="formula-eq">
                FoS = [c'â‚‘ff + (Î³z cosÂ²Î² - u)tan Ï†'â‚‘ff] / [Î³z sinÎ² cosÎ²]
            </div>
            <div class="formula-desc">
                <strong>Where:</strong><br>
                â€¢ c'â‚‘ff = effective cohesion (kPa)<br>
                â€¢ Î³ = unit weight of soil (kN/mÂ³)<br>
                â€¢ z = soil depth (m)<br>
                â€¢ Î² = slope angle (degrees)<br>
                â€¢ u = pore water pressure (kPa)<br>
                â€¢ Ï†'â‚‘ff = effective friction angle (degrees)
            </div>
        </div>
    
        <div class="formula-section">
            <h4>ğŸŒ¿ Vegetation Effect on Cohesion</h4>
            <div class="formula-eq">
                c'â‚‘ff = c'â‚€ Ã— (1 + 0.15V) Ã— (1 - 0.55E)
            </div>
            <div class="formula-desc">
                <strong>Parameters:</strong><br>
                â€¢ c'â‚€ = base cohesion<br>
                â€¢ V = vegetation cover (0-1)<br>
                â€¢ E = erosion level (0-1)<br>
                <strong>Effect:</strong> Vegetation adds root cohesion (~15% increase), erosion removes it (~55% loss)
            </div>
        </div>
    
        <div class="formula-section">
            <h4>ğŸ’§ Pore Pressure Ratio (ráµ¤)</h4>
            <div class="formula-eq">
                ráµ¤(t) = ráµ¤â‚€ + [min(I,k)Â·t]/(nÂ·z) Â· f(k)
            </div>
            <div class="formula-desc">
                <strong>Components:</strong><br>
                â€¢ ráµ¤â‚€ = initial moisture (0-1)<br>
                â€¢ I = rainfall intensity (mm/hr)<br>
                â€¢ k = hydraulic conductivity (m/s)<br>
                â€¢ n = porosity (~0.35)<br>
                â€¢ f(k) = permeability factor<br>
                <strong>Note:</strong> Infiltration limited by min(rainfall, conductivity)
            </div>
        </div>
    
        <div class="formula-section">
            <h4>ğŸ“Š Probability of Failure (PoF)</h4>
            <div class="formula-eq">
                PoF = Î¦[(1 - Î¼_FoS) / Ïƒ_FoS]<br>
                where Ïƒ_FoS = CoV Ã— Î¼_FoS
            </div>
            <div class="formula-desc">
                <strong>FOSM Method:</strong><br>
                â€¢ Î¦ = standard normal CDF<br>
                â€¢ CoV = coefficient of variation<br>
                â€¢ Î¼_FoS = mean factor of safety<br>
                <strong>Interpretation:</strong> Accounts for parameter uncertainty in soil properties
            </div>
        </div>
    
        <div class="formula-section">
            <h4>âš–ï¸ Mohr-Coulomb Criterion</h4>
            <div class="formula-eq">
                Ï„f = c' + Ïƒ' Ã— tan(Ï†')
            </div>
            <div class="formula-desc">
                <strong>Shear Strength:</strong><br>
                â€¢ Ï„f = shear strength<br>
                â€¢ Ïƒ' = effective normal stress<br>
                â€¢ Failure occurs when driving stress exceeds shear strength
            </div>
        </div>
    
        <div class="zoom-controls">
            <button class="zoom-btn" onclick="zoomPanel(-1)">ğŸ”- Zoom Out</button>
            <button class="zoom-btn" onclick="zoomPanel(1)">ğŸ”+ Zoom In</button>
        </div>
        <div class="zoom-level" id="zoomLevel">Zoom: 100%</div>
    </div>
</div>

<div id="tooltip" class="tooltip"></div>

<script src="script.js"></script>
</body>
</html>